{"remainingRequest":"/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/src/pages/CRM.vue?vue&type=style&index=0&id=2fc4d82c&lang=scss","dependencies":[{"path":"/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/src/pages/CRM.vue","mtime":1705220631197},{"path":"/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/node_modules/css-loader/index.js","mtime":1703513904904},{"path":"/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1703513905431},{"path":"/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/node_modules/sass-loader/dist/cjs.js","mtime":1703513904908},{"path":"/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/node_modules/cache-loader/dist/cjs.js","mtime":1703513905140},{"path":"/Users/wanchengting/Desktop/數位商務應用/airplane_rev_manage_F/frontend/node_modules/vue-loader/lib/index.js","mtime":1703513905274}],"contextDependencies":[],"result":["\n.cus_eq {\n  margin: 10px;\n  font-size: 20px;\n}\n\n",{"version":3,"sources":["CRM.vue"],"names":[],"mappings":";AA8gBA;AACA;AACA;AACA","file":"CRM.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div>\n\n\n    <!--Charts-->\n    <div class=\"row\">\n      <!-- 分成左右兩半 -->\n\n        <div class=\"col-6\">\n        <chart-card\n          title=\"每期留存率\"\n          sub-title=\"Retention Rate\"\n          :chart-data=\"retentionChart.data\"\n          :chart-options=\"retentionChart.options\"\n        >\n          <!-- <span slot=\"footer\">\n            <i class=\"ti-check\"></i> Data information certified\n          </span> -->\n          <div slot=\"legend\">\n            <i class=\"fa fa-circle text-info\"></i> 留存率\n          </div>\n        </chart-card>\n        </div>\n        <div class=\"col-6\">\n        <chart-card\n          title=\"每期存活率\"\n          sub-title=\"Survival Rate\"\n          :chart-data=\"survivalChart.data\"\n          :chart-options=\"survivalChart.options\"\n        >\n          <!-- <span slot=\"footer\">\n            <i class=\"ti-check\"></i> Data information certified\n          </span> -->\n          <div slot=\"legend\">\n            <i class=\"fa fa-circle text-info\"></i> 存活率\n          </div>\n        </chart-card>\n        </div>\n      </div>\n      <div class=\"row\">\n        <div class=\"col-12\">\n        <card :title=\"table1.title\">\n          <span> 排序依據： </span>\n          <select v-model=\"value\" placeholder=\"請選擇排序依據\"  style=\"border: 0px solid #fffcf5;width:470px;\" class=\"form-control\" @change=\"handleOrderChange\">\n              <option\n                v-for=\"item in options\"\n                :key=\"item\"\n                :label=\"item\"\n                :value=\"item\"           \n                >\n              </option>\n            </select>\n          <div slot=\"raw-content\" class=\"table-responsive\">\n            <paper-table :data=\"table1.data\" :columns=\"table1.columns\">\n            </paper-table>\n            <hr/>\n          <div class=\"cus_eq\"> Customer Equity: {{ customer_equity }}</div>\n          </div>\n          \n        </card>\n      </div>\n      </div>\n      \n      <!-- rfm 表格  -->\n      <div class=\"row\">\n        <div class=\"col-12\">\n        <card :title=\"table2.title\">\n          <div slot=\"raw-content\" class=\"table-responsive\">\n            <paper-table :data=\"table2.data\" :columns=\"table2.columns\">\n            </paper-table>\n          </div>\n          \n        </card>\n      </div>\n      </div>\n\n     \n\n      \n    \n  </div>\n</template>\n<script>\nimport { StatsCard, ChartCard } from \"@/components/index\";\n// import Chartist from \"chartist\";\nimport 'element-ui/lib/theme-chalk/index.css';\n\nimport { Option, Select, Button } from 'element-ui';\nimport { PaperTable } from \"@/components\";\nimport axios from 'axios';\nconst tableColumns = [\n    'CustomerID',\n    \"Customer_name\",\n    \"Gender\",\n    \"PhoneNumber\",\n    \"Birthday\",\n    \"Email\",\n    \"Address\",\n    \"LTV\",\n    \"PCV\",\n    \"RFM\",\n\n  ];\n  const tableColumns2 = [\n    \"Classfication\",\n    \"Recency\",\n    \"Frequency\",\n    \"Monetary\",\n    \"Percentage_of_People\",\n    \"Percentage_of_Revenue\",\n  ];\n\n  // 'CustomerID': 1,\n  //       'Customer_name': 'yen chen',\n  //       'Gender': 'male',\n  //       'PhoneNumber': '0912345678',\n  //       'Birthday': datetime.date(2000, 3, 5),\n  //       'Email': 'yen@gmail.com',\n  //       'Address': 'nccu, wenshang district, Taipei city',\n  //       'LTV': 54069.74752117492,\n  //       'PCV': 59851.851851851854,\n  //       'RFM': '5'\nlet tableData = [];\nlet tableData2 = [];\n// axios.get('http://34.125.243.130:5000/get_customer_info')\n//         .then(res => {\n//           // handle the response data\n//           for(let i = 0; i < res.data.customer_info.length; i++) {\n//                 const inputData = {};\n//                 inputData.customerid = res.data.customer_info[i].CustomerID;\n//                 inputData.customer_name = res.data.customer_info[i].Customer_name;\n//                 inputData.gender = res.data.customer_info[i].Gender;\n//                 inputData.phonenumber = res.data.customer_info[i].PhoneNumber;\n//                 inputData.birthday = res.data.customer_info[i].Birthday;\n//                 inputData.email = res.data.customer_info[i].Email;\n//                 inputData.address = res.data.customer_info[i].Address;\n//                 inputData.ltv = res.data.customer_info[i].LTV;\n//                 inputData.pcv = res.data.customer_info[i].PCV;\n//                 inputData.rfm = res.data.customer_info[i].RFM;\n\n\n//                 tableData.push(inputData);\n              \n//            }\n//            this.table1.data = [...tableData];\n         \n//           // console.log(res.data);\n//           console.log(tableData);\n//         })\n//         .catch(error => {\n//           // handle errors\n//           console.error('Error fetching data:', error);\n//         });\n        let retention_rate = [];\n        axios.get('http://34.125.243.130:5000/get_retention_rate')\n        .then(res => {\n          // handle the response data\n          retention_rate = [];\n          retention_rate.push(res.data.retention_rate[0][\"2023 Q1\"]);\n          retention_rate.push(res.data.retention_rate[1][\"2023 Q2\"]);\n          retention_rate.push(res.data.retention_rate[2][\"2023 Q3\"]);\n          retention_rate.push(res.data.retention_rate[3][\"2023 Q4\"]);\n          console.log(res.data);\n      \n          // this.retentionChart.data.series[0] = [...retention_rate];\n         \n         \n          // console.log(res.data);\n          console.log();\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n        const survival_rate = [];\n        axios.get('http://34.125.243.130:5000/get_survival_rate')\n        .then(res => {\n          // handle the response data\n          survival_rate.push(Number(res.data.survival_rate[0][\"2023 Q1\"]));\n          survival_rate.push(Number(res.data.survival_rate[1][\"2023 Q2\"]));\n          survival_rate.push(Number(res.data.survival_rate[2][\"2023 Q3\"]));\n          survival_rate.push(Number(res.data.survival_rate[3][\"2023 Q4\"]));\n          console.log(survival_rate);\n           \n\n          // console.log(res.data);\n          // console.log(res.data.survival_rate[\"2023_Q1\"]);\n          // console.log(survival_rate);\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n\nexport default {\n  components: {\n    StatsCard,\n    ChartCard,\n    PaperTable,\n    Option,\n    Select,\n  },\n  /**\n   * Chart data used to render stats, charts. Should be replaced with server data\n   */\n  data() {\n    return {\n      options: [\n       \"ID\",\n       \"LTV\",\n       \"PCV\",\n       \n      ],\n      value: \"ID\",\n      table1: {\n          title: \"顧客資訊\",\n          subTitle: \"\",\n          columns: [...tableColumns],\n          data: [...tableData],\n        },\n      table2: {\n          title: \"RFM 分析結果\",\n          subTitle: \"\",\n          columns: [...tableColumns2],\n          data: [...tableData2],\n      },\n      \n     \n      retentionChart: {\n        data: {\n          labels: [\n            \"2023 Q1\",\n            \"2023 Q2\",\n            \"2023 Q3\",\n            \"2023 Q4\",\n          ],\n          series: [\n            [...retention_rate],\n            // [230, 293, 380, 480, 503, 553, 600, 664, 698, 710, 736, 795],\n        ],\n        },\n        options: {\n          seriesBarDistance: 10,\n          axisX: {\n            showGrid: false,\n          },\n          height: \"245px\",\n        },\n      },\n      survivalChart: {\n        data: {\n          labels: [\n          \"2023 Q1\",\n            \"2023 Q2\",\n            \"2023 Q3\",\n            \"2023 Q4\",\n          ],\n          series: [\n            [...survival_rate],\n            // [230, 293, 380, 480, 503, 553, 600, 664, 698, 710, 736, 795],\n          ],\n        },\n        options: {\n          seriesBarDistance: 10,\n          axisX: {\n            showGrid: false,\n          },\n          height: \"245px\",\n        },\n      },\n      customer_equity: 150000,\n      \n    };\n  },\n  methods: {\n    handleOrderChange(){\n      if(this.value == \"LTV\"){\n        this.fetchData_LTV();\n      } else if(this.value == \"PCV\"){\n        this.fetchData_PCV();\n      } else{\n        this.fetchData_ID();\n      }\n    },\n    fetchData(){\n      axios.get('http://34.125.243.130:5000/get_customer_info')\n        .then(res => {\n          // handle the response data\n          tableData = [];\n          for(let i = 0; i < res.data.customer_info.length; i++) {\n                const inputData = {};\n                inputData.customerid = res.data.customer_info[i].CustomerID;\n                inputData.customer_name = res.data.customer_info[i].Customer_name;\n                inputData.gender = res.data.customer_info[i].Gender;\n                inputData.phonenumber = res.data.customer_info[i].PhoneNumber;\n                inputData.birthday = res.data.customer_info[i].Birthday;\n                inputData.email = res.data.customer_info[i].Email;\n                inputData.address = res.data.customer_info[i].Address;\n                inputData.ltv = res.data.customer_info[i].LTV;\n                inputData.pcv = res.data.customer_info[i].PCV;\n                inputData.rfm = res.data.customer_info[i].RFM;\n\n\n                tableData.push(inputData);\n              \n           }\n           this.table1.data = [...tableData];\n         \n          // console.log(res.data);\n          // console.log(tableData);\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n    },\n\n    // 載入 RFM 資料\n    fetchData_RFM () {\n      axios.get('http://34.125.243.130:5000/RFM')\n        .then(res => {\n          // handle the response data\n          tableData2 = [];\n         \n                let inputData = {};\n                inputData.classfication = \"黃金客\";\n                inputData.recency = res.data.RFM_info.import_customer.recency;\n                inputData.frequency = res.data.RFM_info.import_customer.frequency;\n                inputData.monetary = res.data.RFM_info.import_customer.monetary;\n                inputData.percentage_of_people = res.data.RFM_info.import_customer.num_rate;\n                inputData.percentage_of_revenue = res.data.RFM_info.import_customer.revenue_rate;\n\n                tableData2.push(inputData);\n\n                inputData = {};\n                inputData.classfication = \"一般客\";\n                inputData.recency = res.data.RFM_info.general_customer.recency;\n                inputData.frequency = res.data.RFM_info.general_customer.frequency;\n                inputData.monetary = res.data.RFM_info.general_customer.monetary;\n                inputData.percentage_of_people = res.data.RFM_info.general_customer.num_rate;\n                inputData.percentage_of_revenue = res.data.RFM_info.general_customer.revenue_rate;\n\n                tableData2.push(inputData);\n\n                inputData = {};\n                inputData.classfication = \"沈睡客\";\n                inputData.recency = res.data.RFM_info.sleeping_customer.recency;\n                inputData.frequency = res.data.RFM_info.sleeping_customer.frequency;\n                inputData.monetary = res.data.RFM_info.sleeping_customer.monetary;\n                inputData.percentage_of_people = res.data.RFM_info.sleeping_customer.num_rate;\n                inputData.percentage_of_revenue = res.data.RFM_info.sleeping_customer.revenue_rate;\n\n                tableData2.push(inputData);\n\n\n\n           this.table2.data = [...tableData2];\n         \n          // console.log(res.data);\n          // console.log(tableData);\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n    },\n\n    fetchData_LTV(){\n      axios.get('http://34.125.243.130:5000/LTV_order')\n        .then(res => {\n          // handle the response data\n          tableData = [];\n          for(let i = 0; i < res.data.cust_info_LTV_Ordered.length; i++) {\n                const inputData = {};\n                inputData.customerid = res.data.cust_info_LTV_Ordered[i].CustomerID;\n                inputData.customer_name = res.data.cust_info_LTV_Ordered[i].Customer_name;\n                inputData.gender = res.data.cust_info_LTV_Ordered[i].Gender;\n                inputData.phonenumber = res.data.cust_info_LTV_Ordered[i].PhoneNumber;\n                inputData.birthday = res.data.cust_info_LTV_Ordered[i].Birthday;\n                inputData.email = res.data.cust_info_LTV_Ordered[i].Email;\n                inputData.address = res.data.cust_info_LTV_Ordered[i].Address;\n                inputData.ltv = res.data.cust_info_LTV_Ordered[i].LTV;\n                inputData.pcv = res.data.cust_info_LTV_Ordered[i].PCV;\n                inputData.rfm = res.data.cust_info_LTV_Ordered[i].RFM;\n\n\n                tableData.push(inputData);\n              \n           }\n           this.table1.data = [...tableData];\n         \n          // console.log(res.data);\n          // console.log(tableData);\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n    },\n    fetchData_PCV(){\n      axios.get('http://34.125.243.130:5000/PCV_order')\n        .then(res => {\n          // handle the response data\n          tableData = [];\n          for(let i = 0; i < res.data.cust_info_PCV_Ordered.length; i++) {\n                const inputData = {};\n                inputData.customerid = res.data.cust_info_PCV_Ordered[i].CustomerID;\n                inputData.customer_name = res.data.cust_info_PCV_Ordered[i].Customer_name;\n                inputData.gender = res.data.cust_info_PCV_Ordered[i].Gender;\n                inputData.phonenumber = res.data.cust_info_PCV_Ordered[i].PhoneNumber;\n                inputData.birthday = res.data.cust_info_PCV_Ordered[i].Birthday;\n                inputData.email = res.data.cust_info_PCV_Ordered[i].Email;\n                inputData.address = res.data.cust_info_PCV_Ordered[i].Address;\n                inputData.ltv = res.data.cust_info_PCV_Ordered[i].LTV;\n                inputData.pcv = res.data.cust_info_PCV_Ordered[i].PCV;\n                inputData.rfm = res.data.cust_info_PCV_Ordered[i].RFM;\n\n\n                tableData.push(inputData);\n              \n           }\n           this.table1.data = [...tableData];\n         \n          // console.log(res.data);\n          // console.log(tableData);\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n    },\n\n    fetchData_ID(){\n      axios.get('http://34.125.243.130:5000/ID_order')\n        .then(res => {\n          // handle the response data\n          tableData = [];\n          for(let i = 0; i < res.data.cust_info_ID_Ordered.length; i++) {\n                const inputData = {};\n                inputData.customerid = res.data.cust_info_ID_Ordered[i].CustomerID;\n                inputData.customer_name = res.data.cust_info_ID_Ordered[i].Customer_name;\n                inputData.gender = res.data.cust_info_ID_Ordered[i].Gender;\n                inputData.phonenumber = res.data.cust_info_ID_Ordered[i].PhoneNumber;\n                inputData.birthday = res.data.cust_info_ID_Ordered[i].Birthday;\n                inputData.email = res.data.cust_info_ID_Ordered[i].Email;\n                inputData.address = res.data.cust_info_ID_Ordered[i].Address;\n                inputData.ltv = res.data.cust_info_ID_Ordered[i].LTV;\n                inputData.pcv = res.data.cust_info_ID_Ordered[i].PCV;\n                inputData.rfm = res.data.cust_info_ID_Ordered[i].RFM;\n\n\n                tableData.push(inputData);\n              \n           }\n           this.table1.data = [...tableData];\n         \n          // console.log(res.data);\n          // console.log(tableData);\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n    },\n\n    fetchData2() {\n      axios.get('http://34.125.243.130:5000/get_retention_rate')\n        .then(res => {\n          // handle the response data\n          retention_rate = [];\n          retention_rate.push(res.data.retention_rate[0][\"2023 Q1\"]);\n          retention_rate.push(res.data.retention_rate[1][\"2023 Q2\"]);\n          retention_rate.push(res.data.retention_rate[2][\"2023 Q3\"]);\n          retention_rate.push(res.data.retention_rate[3][\"2023 Q4\"]);\n          console.log(res.data);\n          console.log(res.data.retention_rate[0][\"2023 Q1\"]);\n          console.log(retention_rate);\n          console.log(\"retention_rate\");\n          // this.retentionChart.data.series[0] = [...retention_rate];\n          this.$set(this.retentionChart.data, 'series', [[...retention_rate]]);\n         \n\n          console.log(this.retentionChart.data.series[0]);\n         \n          // console.log(res.data);\n          console.log();\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n        // this.retentionChart.data.series[0] = [...retention_rate];\n    },\n\n    fetchDataCusEq () {\n      axios.get('http://34.125.243.130:5000/CE')\n        .then(res => {\n          // handle the response data\n          \n         this.customer_equity = res.data['customer equity'][0]['customer equity'];\n          console.log(res.data);\n        })\n        .catch(error => {\n          // handle errors\n          console.error('Error fetching data:', error);\n        });\n    },\n    \n  },\n  mounted(){\n    this.fetchData();\n    // this.fetchData2();\n    this.$forceUpdate();\n    this.fetchDataCusEq();\n    this.fetchData_RFM();\n  },\n};\n</script>\n<style lang=\"scss\">\n  .cus_eq {\n    margin: 10px;\n    font-size: 20px;\n  }\n\n</style>\n"]}]}